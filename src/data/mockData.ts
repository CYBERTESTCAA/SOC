import { 
  Incident, SignInLog, DeviceCompliance, SOCMetrics, WeeklySummary, 
  Severity, SignInAnomaly, ConnectorInfo, AuditLogEntry, SOCUser,
  ReportTemplate, DataFreshness, TimelineEvent, IncidentAlert, IncidentComment
} from '@/types/soc';

// Extended incidents with full details
export const mockIncidents: Incident[] = [
  {
    id: 'INC-2024-001',
    title: 'Suspicious PowerShell execution detected',
    description: 'Multiple encoded PowerShell commands executed from user workstation. Potential malicious script activity.',
    severity: 'critical',
    status: 'inProgress',
    source: 'defender',
    createdAt: new Date(Date.now() - 2 * 60 * 60 * 1000),
    updatedAt: new Date(Date.now() - 30 * 60 * 1000),
    assignedTo: 'analyst@contoso.com',
    affectedEntities: {
      users: ['john.doe@contoso.com'],
      devices: ['DESKTOP-JD01'],
      ips: ['192.168.1.105'],
    },
    mitre: {
      tactic: 'Execution',
      technique: 'PowerShell',
      techniqueId: 'T1059.001',
    },
    riskScore: 87,
    impactedUsersCount: 1,
    impactedDevicesCount: 1,
    confidence: 'high',
    tags: ['ransomware-suspicion', 'priority'],
    slaDeadline: new Date(Date.now() + 30 * 60 * 1000),
    recommendations: [
      'Isoler immédiatement le poste DESKTOP-JD01',
      'Révoquer les sessions actives de john.doe@contoso.com',
      'Analyser les processus parent/enfant PowerShell',
      'Vérifier les connexions réseau sortantes',
    ],
    alerts: [
      { id: 'ALT-001', title: 'Encoded PowerShell command detected', severity: 'critical', timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000), source: 'defender', status: 'active' },
      { id: 'ALT-002', title: 'Suspicious process behavior', severity: 'high', timestamp: new Date(Date.now() - 1.5 * 60 * 60 * 1000), source: 'defender', status: 'active' },
      { id: 'ALT-003', title: 'Potential data exfiltration attempt', severity: 'high', timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000), source: 'defender', status: 'active' },
    ],
    timeline: [
      { id: 'TL-001', timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000), type: 'detection', title: 'Incident détecté', description: 'Microsoft Defender a détecté une exécution PowerShell suspecte', severity: 'critical' },
      { id: 'TL-002', timestamp: new Date(Date.now() - 1.9 * 60 * 60 * 1000), type: 'alert', title: 'Alerte créée', description: 'Encoded PowerShell command detected' },
      { id: 'TL-003', timestamp: new Date(Date.now() - 1.5 * 60 * 60 * 1000), type: 'status', title: 'Statut changé', description: 'Nouveau → En cours', actor: 'analyst@contoso.com' },
      { id: 'TL-004', timestamp: new Date(Date.now() - 1.2 * 60 * 60 * 1000), type: 'action', title: 'Assignation', description: 'Incident assigné à analyst@contoso.com', actor: 'admin@contoso.com' },
      { id: 'TL-005', timestamp: new Date(Date.now() - 45 * 60 * 1000), type: 'comment', title: 'Commentaire ajouté', description: 'Investigation en cours, analyse des logs PowerShell', actor: 'analyst@contoso.com' },
    ],
    comments: [
      { id: 'CMT-001', author: 'analyst@contoso.com', content: 'Investigation démarrée. Analyse des logs PowerShell en cours.', timestamp: new Date(Date.now() - 45 * 60 * 1000) },
      { id: 'CMT-002', author: 'analyst@contoso.com', content: 'Détection de connexion vers IP externe suspecte : 185.xxx.xxx.xx', timestamp: new Date(Date.now() - 30 * 60 * 1000) },
    ],
  },
  {
    id: 'INC-2024-002',
    title: 'Multiple failed sign-in attempts from unusual location',
    description: 'User account experiencing brute-force attack from IP address in Russia.',
    severity: 'high',
    status: 'new',
    source: 'entra',
    createdAt: new Date(Date.now() - 45 * 60 * 1000),
    updatedAt: new Date(Date.now() - 45 * 60 * 1000),
    affectedEntities: {
      users: ['marie.smith@contoso.com'],
      ips: ['185.156.73.xx'],
    },
    mitre: {
      tactic: 'Credential Access',
      technique: 'Brute Force',
      techniqueId: 'T1110',
    },
    riskScore: 72,
    impactedUsersCount: 1,
    impactedDevicesCount: 0,
    confidence: 'high',
    slaDeadline: new Date(Date.now() + 4 * 60 * 60 * 1000),
    recommendations: [
      'Vérifier que MFA est activé pour marie.smith@contoso.com',
      'Bloquer l\'IP 185.156.73.xx',
      'Réinitialiser le mot de passe si compromis',
    ],
    timeline: [
      { id: 'TL-010', timestamp: new Date(Date.now() - 45 * 60 * 1000), type: 'detection', title: 'Incident détecté', description: 'Détection de tentatives de brute-force' },
    ],
  },
  {
    id: 'INC-2024-003',
    title: 'Device encryption disabled',
    description: 'BitLocker encryption was disabled on executive laptop.',
    severity: 'high',
    status: 'new',
    source: 'intune',
    createdAt: new Date(Date.now() - 3 * 60 * 60 * 1000),
    updatedAt: new Date(Date.now() - 3 * 60 * 60 * 1000),
    affectedEntities: {
      users: ['ceo@contoso.com'],
      devices: ['LAPTOP-CEO-01'],
    },
    mitre: {
      tactic: 'Defense Evasion',
      technique: 'Disable Security Tools',
      techniqueId: 'T1562.001',
    },
    riskScore: 68,
    impactedUsersCount: 1,
    impactedDevicesCount: 1,
    confidence: 'high',
    tags: ['vip-user', 'priority'],
    slaDeadline: new Date(Date.now() + 2 * 60 * 60 * 1000),
    recommendations: [
      'Contacter le CEO pour comprendre la raison',
      'Forcer la réactivation BitLocker via policy',
      'Vérifier les autres paramètres de sécurité',
    ],
  },
  {
    id: 'INC-2024-004',
    title: 'Suspicious email forwarding rule created',
    description: 'New inbox rule forwarding emails to external address detected.',
    severity: 'medium',
    status: 'inProgress',
    source: 'exchange',
    createdAt: new Date(Date.now() - 5 * 60 * 60 * 1000),
    updatedAt: new Date(Date.now() - 2 * 60 * 60 * 1000),
    assignedTo: 'security@contoso.com',
    affectedEntities: {
      users: ['finance@contoso.com'],
      mailboxes: ['finance@contoso.com'],
    },
    mitre: {
      tactic: 'Collection',
      technique: 'Email Collection',
      techniqueId: 'T1114',
    },
    riskScore: 55,
    impactedUsersCount: 1,
    impactedDevicesCount: 0,
    confidence: 'medium',
    recommendations: [
      'Supprimer la règle de transfert',
      'Vérifier les emails déjà transférés',
      'Réinitialiser le mot de passe finance@contoso.com',
    ],
  },
  {
    id: 'INC-2024-005',
    title: 'Malware detected and quarantined',
    description: 'Trojan.GenericKD detected in downloaded file. File has been quarantined.',
    severity: 'medium',
    status: 'resolved',
    source: 'defender',
    createdAt: new Date(Date.now() - 8 * 60 * 60 * 1000),
    updatedAt: new Date(Date.now() - 6 * 60 * 60 * 1000),
    assignedTo: 'analyst@contoso.com',
    affectedEntities: {
      users: ['dev.team@contoso.com'],
      devices: ['DESKTOP-DEV-03'],
    },
    mitre: {
      tactic: 'Execution',
      technique: 'User Execution',
      techniqueId: 'T1204',
    },
    riskScore: 45,
    impactedUsersCount: 1,
    impactedDevicesCount: 1,
    confidence: 'high',
  },
  {
    id: 'INC-2024-006',
    title: 'Compliance policy deployment failed',
    description: 'Windows security baseline failed to deploy on 12 devices.',
    severity: 'low',
    status: 'new',
    source: 'intune',
    createdAt: new Date(Date.now() - 24 * 60 * 60 * 1000),
    updatedAt: new Date(Date.now() - 24 * 60 * 60 * 1000),
    affectedEntities: {
      devices: ['DESKTOP-01', 'DESKTOP-02', 'LAPTOP-05', '...+9 more'],
    },
    riskScore: 25,
    impactedUsersCount: 12,
    impactedDevicesCount: 12,
    confidence: 'high',
  },
];

export const mockSignInLogs: SignInLog[] = [
  {
    id: 'SL-001',
    userPrincipalName: 'marie.smith@contoso.com',
    ipAddress: '185.156.73.xx',
    location: 'Moscow, Russia',
    country: 'Russia',
    status: 'failure',
    riskLevel: 'critical',
    timestamp: new Date(Date.now() - 10 * 60 * 1000),
    appDisplayName: 'Microsoft 365',
    deviceInfo: 'Windows 10 - Chrome',
    mfaRequired: true,
    mfaResult: 'notRequired',
    conditionalAccessStatus: 'failed',
    clientAppUsed: 'Browser',
    isInteractive: true,
  },
  {
    id: 'SL-002',
    userPrincipalName: 'john.doe@contoso.com',
    ipAddress: '192.168.1.105',
    location: 'Paris, France',
    country: 'France',
    status: 'success',
    riskLevel: 'low',
    timestamp: new Date(Date.now() - 25 * 60 * 1000),
    appDisplayName: 'Azure Portal',
    deviceInfo: 'Windows 11 - Edge',
    mfaRequired: true,
    mfaResult: 'success',
    conditionalAccessStatus: 'success',
    clientAppUsed: 'Browser',
    isInteractive: true,
  },
  {
    id: 'SL-003',
    userPrincipalName: 'admin@contoso.com',
    ipAddress: '10.0.0.15',
    location: 'Lyon, France',
    country: 'France',
    status: 'success',
    riskLevel: 'info',
    timestamp: new Date(Date.now() - 45 * 60 * 1000),
    appDisplayName: 'Microsoft Admin Center',
    deviceInfo: 'macOS - Safari',
    mfaRequired: true,
    mfaResult: 'success',
    conditionalAccessStatus: 'success',
    clientAppUsed: 'Browser',
    isInteractive: true,
  },
  {
    id: 'SL-004',
    userPrincipalName: 'guest.user@external.com',
    ipAddress: '203.45.67.89',
    location: 'Unknown',
    country: 'China',
    status: 'failure',
    riskLevel: 'high',
    timestamp: new Date(Date.now() - 60 * 60 * 1000),
    appDisplayName: 'SharePoint Online',
    deviceInfo: 'Unknown Device',
    mfaRequired: false,
    mfaResult: 'notRequired',
    conditionalAccessStatus: 'notApplied',
    clientAppUsed: 'Legacy Auth',
    isInteractive: false,
  },
  {
    id: 'SL-005',
    userPrincipalName: 'ceo@contoso.com',
    ipAddress: '192.168.1.50',
    location: 'Paris, France',
    country: 'France',
    status: 'success',
    riskLevel: 'low',
    timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000),
    appDisplayName: 'Microsoft Teams',
    deviceInfo: 'iOS - Teams App',
    mfaRequired: true,
    mfaResult: 'success',
    conditionalAccessStatus: 'success',
    clientAppUsed: 'Mobile App',
    isInteractive: true,
  },
  {
    id: 'SL-006',
    userPrincipalName: 'marie.smith@contoso.com',
    ipAddress: '185.156.73.xx',
    location: 'Moscow, Russia',
    country: 'Russia',
    status: 'failure',
    riskLevel: 'critical',
    timestamp: new Date(Date.now() - 12 * 60 * 1000),
    appDisplayName: 'Microsoft 365',
    deviceInfo: 'Windows 10 - Chrome',
    mfaRequired: true,
    mfaResult: 'notRequired',
    conditionalAccessStatus: 'failed',
    clientAppUsed: 'Browser',
    isInteractive: true,
  },
  {
    id: 'SL-007',
    userPrincipalName: 'marie.smith@contoso.com',
    ipAddress: '185.156.73.xx',
    location: 'Moscow, Russia',
    country: 'Russia',
    status: 'failure',
    riskLevel: 'critical',
    timestamp: new Date(Date.now() - 15 * 60 * 1000),
    appDisplayName: 'Microsoft 365',
    deviceInfo: 'Windows 10 - Chrome',
    mfaRequired: true,
    mfaResult: 'notRequired',
    conditionalAccessStatus: 'failed',
    clientAppUsed: 'Browser',
    isInteractive: true,
  },
];

export const mockAnomalies: SignInAnomaly[] = [
  {
    id: 'ANM-001',
    type: 'bruteforce',
    severity: 'critical',
    timestamp: new Date(Date.now() - 10 * 60 * 1000),
    userPrincipalName: 'marie.smith@contoso.com',
    description: 'Détection de tentative de brute-force : 15 échecs de connexion en 5 minutes depuis une IP russe',
    details: {
      failedAttempts: 15,
      timeWindow: '5 minutes',
      country: 'Russia',
    },
    relatedLogs: ['SL-001', 'SL-006', 'SL-007'],
    status: 'new',
  },
  {
    id: 'ANM-002',
    type: 'impossibleTravel',
    severity: 'high',
    timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000),
    userPrincipalName: 'sales.rep@contoso.com',
    description: 'Connexion depuis Paris puis Tokyo en 30 minutes - voyage impossible',
    details: {
      sourceLocation: 'Paris, France',
      destLocation: 'Tokyo, Japan',
      travelTime: '30 minutes',
    },
    relatedLogs: [],
    status: 'investigating',
  },
  {
    id: 'ANM-003',
    type: 'rareCountry',
    severity: 'medium',
    timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000),
    userPrincipalName: 'dev.team@contoso.com',
    description: 'Première connexion depuis le Brésil - pays non observé dans l\'historique',
    details: {
      country: 'Brazil',
      previousCountries: ['France', 'Germany', 'USA'],
    },
    relatedLogs: [],
    status: 'new',
  },
  {
    id: 'ANM-004',
    type: 'newDevice',
    severity: 'low',
    timestamp: new Date(Date.now() - 6 * 60 * 60 * 1000),
    userPrincipalName: 'finance@contoso.com',
    description: 'Connexion depuis un nouvel appareil non enregistré avec échec MFA',
    details: {
      deviceInfo: 'Android - Unknown Device',
    },
    relatedLogs: [],
    status: 'resolved',
  },
  {
    id: 'ANM-005',
    type: 'legacyAuth',
    severity: 'medium',
    timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000),
    userPrincipalName: 'guest.user@external.com',
    description: 'Utilisation d\'authentification legacy (IMAP) - potentiel contournement MFA',
    details: {},
    relatedLogs: ['SL-004'],
    status: 'new',
  },
];

export const mockDevices: DeviceCompliance[] = [
  {
    id: 'DEV-001',
    deviceName: 'LAPTOP-CEO-01',
    userPrincipalName: 'ceo@contoso.com',
    osVersion: 'Windows 11 Pro 23H2',
    complianceState: 'nonCompliant',
    lastCheckIn: new Date(Date.now() - 3 * 60 * 60 * 1000),
    encryptionStatus: false,
    issues: ['BitLocker disabled', 'Firewall policy pending'],
    bitlockerStatus: false,
    antivirusStatus: 'enabled',
    firewallStatus: 'disabled',
    osOutdated: false,
    isVIP: true,
    model: 'Surface Laptop 5',
    manufacturer: 'Microsoft',
  },
  {
    id: 'DEV-002',
    deviceName: 'DESKTOP-JD01',
    userPrincipalName: 'john.doe@contoso.com',
    osVersion: 'Windows 11 Pro 23H2',
    complianceState: 'compliant',
    lastCheckIn: new Date(Date.now() - 30 * 60 * 1000),
    encryptionStatus: true,
    bitlockerStatus: true,
    antivirusStatus: 'enabled',
    firewallStatus: 'enabled',
    osOutdated: false,
    isVIP: false,
    model: 'OptiPlex 7090',
    manufacturer: 'Dell',
  },
  {
    id: 'DEV-003',
    deviceName: 'LAPTOP-SALES-05',
    userPrincipalName: 'sales.rep@contoso.com',
    osVersion: 'Windows 10 Pro 22H2',
    complianceState: 'nonCompliant',
    lastCheckIn: new Date(Date.now() - 48 * 60 * 60 * 1000),
    encryptionStatus: true,
    issues: ['OS version outdated', 'Last check-in > 24h'],
    bitlockerStatus: true,
    antivirusStatus: 'enabled',
    firewallStatus: 'enabled',
    osOutdated: true,
    isVIP: false,
    model: 'ThinkPad X1 Carbon',
    manufacturer: 'Lenovo',
  },
  {
    id: 'DEV-004',
    deviceName: 'MAC-DESIGN-02',
    userPrincipalName: 'designer@contoso.com',
    osVersion: 'macOS 14.2',
    complianceState: 'compliant',
    lastCheckIn: new Date(Date.now() - 2 * 60 * 60 * 1000),
    encryptionStatus: true,
    bitlockerStatus: true,
    antivirusStatus: 'enabled',
    firewallStatus: 'enabled',
    osOutdated: false,
    isVIP: false,
    model: 'MacBook Pro 14"',
    manufacturer: 'Apple',
  },
  {
    id: 'DEV-005',
    deviceName: 'IPHONE-CEO',
    userPrincipalName: 'ceo@contoso.com',
    osVersion: 'iOS 17.2',
    complianceState: 'pending',
    lastCheckIn: new Date(Date.now() - 12 * 60 * 60 * 1000),
    encryptionStatus: true,
    issues: ['Compliance check pending'],
    isVIP: true,
    model: 'iPhone 15 Pro',
    manufacturer: 'Apple',
  },
];

export const mockMetrics: SOCMetrics = {
  totalIncidents: 47,
  activeIncidents: 8,
  criticalIncidents: 2,
  resolvedToday: 5,
  avgResolutionTime: '2h 34m',
  signInAttempts24h: 1247,
  failedSignIns24h: 23,
  riskySignIns24h: 4,
  totalDevices: 156,
  compliantDevices: 142,
  nonCompliantDevices: 14,
  anomaliesDetected24h: 5,
  mfaChallenged24h: 342,
  mfaFailed24h: 8,
  newCountrySignIns24h: 3,
  bruteforceAttempts24h: 1,
};

export const mockWeeklySummary: WeeklySummary = {
  weekStart: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000),
  weekEnd: new Date(),
  totalIncidents: 47,
  incidentsBySeverity: {
    critical: 2,
    high: 8,
    medium: 15,
    low: 22,
    info: 0,
  },
  topEvents: [
    'Tentative de brute-force sur 3 comptes utilisateurs depuis IP russe',
    'Désactivation BitLocker sur laptop direction - investigation en cours',
    'Règle de transfert email suspecte détectée sur boîte finance',
  ],
  trends: [
    '↑ +15% tentatives de connexion échouées vs semaine précédente',
    '↓ -8% incidents Defender (amélioration post-déploiement EDR)',
    '→ Compliance Intune stable à 91%',
  ],
  recommendations: [
    'Activer MFA obligatoire pour les comptes admin restants',
    'Planifier mise à jour Windows 10 → 11 pour 14 postes',
    'Réviser les règles de transfert email sur toutes les boîtes',
  ],
};

export const mockConnectors: ConnectorInfo[] = [
  {
    id: 'defender',
    name: 'Microsoft Defender XDR',
    status: 'connected',
    lastSync: new Date(Date.now() - 5 * 60 * 1000),
    permissions: ['SecurityEvents.Read.All', 'SecurityIncident.Read.All'],
    dataLag: 5,
  },
  {
    id: 'entra',
    name: 'Microsoft Entra ID',
    status: 'connected',
    lastSync: new Date(Date.now() - 2 * 60 * 1000),
    permissions: ['AuditLog.Read.All', 'SignInReport.Read.All'],
    dataLag: 2,
  },
  {
    id: 'intune',
    name: 'Microsoft Intune',
    status: 'warning',
    lastSync: new Date(Date.now() - 15 * 60 * 1000),
    errorMessage: 'Rate limit reached, retry in 5 min',
    permissions: ['DeviceManagementManagedDevices.Read.All'],
    dataLag: 15,
  },
  {
    id: 'exchange',
    name: 'Exchange Online',
    status: 'connected',
    lastSync: new Date(Date.now() - 8 * 60 * 1000),
    permissions: ['MailboxSettings.Read', 'Reports.Read.All'],
    dataLag: 8,
  },
];

export const mockAuditLogs: AuditLogEntry[] = [
  { id: 'AUD-001', timestamp: new Date(Date.now() - 5 * 60 * 1000), actor: 'analyst@contoso.com', action: 'view', resource: 'Incident', resourceId: 'INC-2024-001', ipAddress: '192.168.1.50' },
  { id: 'AUD-002', timestamp: new Date(Date.now() - 15 * 60 * 1000), actor: 'analyst@contoso.com', action: 'update', resource: 'Incident', resourceId: 'INC-2024-001', details: 'Status changed: new → inProgress', ipAddress: '192.168.1.50' },
  { id: 'AUD-003', timestamp: new Date(Date.now() - 30 * 60 * 1000), actor: 'admin@contoso.com', action: 'assign', resource: 'Incident', resourceId: 'INC-2024-001', details: 'Assigned to analyst@contoso.com', ipAddress: '192.168.1.15' },
  { id: 'AUD-004', timestamp: new Date(Date.now() - 1 * 60 * 60 * 1000), actor: 'security@contoso.com', action: 'export', resource: 'Report', details: 'Weekly Security Summary exported as PDF', ipAddress: '192.168.1.22' },
  { id: 'AUD-005', timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000), actor: 'admin@contoso.com', action: 'setting_change', resource: 'Alert Rules', details: 'Bruteforce threshold changed: 10 → 5', ipAddress: '192.168.1.15' },
  { id: 'AUD-006', timestamp: new Date(Date.now() - 3 * 60 * 60 * 1000), actor: 'helpdesk@contoso.com', action: 'view', resource: 'Device', resourceId: 'DEV-001', ipAddress: '192.168.1.100' },
];

export const mockUsers: SOCUser[] = [
  {
    id: 'USR-001',
    email: 'admin@contoso.com',
    displayName: 'Admin SOC',
    role: 'admin',
    lastLogin: new Date(Date.now() - 30 * 60 * 1000),
    permissions: { canManageIncidents: true, canExport: true, canManageSettings: true, modules: ['defender', 'entra', 'intune', 'exchange'] },
  },
  {
    id: 'USR-002',
    email: 'analyst@contoso.com',
    displayName: 'Analyst SOC',
    role: 'analyst',
    lastLogin: new Date(Date.now() - 5 * 60 * 1000),
    permissions: { canManageIncidents: true, canExport: true, canManageSettings: false, modules: ['defender', 'entra', 'intune', 'exchange'] },
  },
  {
    id: 'USR-003',
    email: 'helpdesk@contoso.com',
    displayName: 'IT Helpdesk',
    role: 'helpdesk',
    lastLogin: new Date(Date.now() - 2 * 60 * 60 * 1000),
    permissions: { canManageIncidents: false, canExport: false, canManageSettings: false, modules: ['intune'] },
  },
  {
    id: 'USR-004',
    email: 'manager@contoso.com',
    displayName: 'Security Manager',
    role: 'readonly',
    lastLogin: new Date(Date.now() - 24 * 60 * 60 * 1000),
    permissions: { canManageIncidents: false, canExport: true, canManageSettings: false, modules: ['defender', 'entra', 'intune', 'exchange'] },
  },
];

export const mockReportTemplates: ReportTemplate[] = [
  {
    id: 'RPT-001',
    name: 'Weekly Security Summary',
    description: 'Synthèse hebdomadaire pour le management (5-10 lignes)',
    type: 'security_summary',
    modules: ['defender', 'entra', 'intune', 'exchange'],
    format: 'pdf',
    schedule: { frequency: 'weekly', dayOfWeek: 1, time: '08:00' },
    recipients: ['manager@contoso.com', 'ciso@contoso.com'],
    lastGenerated: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
    isActive: true,
  },
  {
    id: 'RPT-002',
    name: 'Identity & Access Weekly',
    description: 'Rapport détaillé des connexions, échecs et anomalies',
    type: 'identity_access',
    modules: ['entra'],
    format: 'pdf',
    schedule: { frequency: 'weekly', dayOfWeek: 5, time: '17:00' },
    recipients: ['security@contoso.com'],
    lastGenerated: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
    isActive: true,
  },
  {
    id: 'RPT-003',
    name: 'Endpoint Compliance Weekly',
    description: 'État de conformité du parc, OS outdated, chiffrement',
    type: 'endpoint_compliance',
    modules: ['intune'],
    format: 'csv',
    schedule: { frequency: 'weekly', dayOfWeek: 5, time: '18:00' },
    recipients: ['it-ops@contoso.com'],
    lastGenerated: new Date(Date.now() - 4 * 24 * 60 * 60 * 1000),
    isActive: true,
  },
  {
    id: 'RPT-004',
    name: 'Daily Incidents Report',
    description: 'Rapport quotidien des nouveaux incidents',
    type: 'security_summary',
    modules: ['defender'],
    format: 'html',
    schedule: { frequency: 'daily', time: '09:00' },
    recipients: ['analyst@contoso.com'],
    isActive: false,
  },
];

export const mockDataFreshness: DataFreshness[] = [
  { source: 'defender', lastUpdate: new Date(Date.now() - 5 * 60 * 1000), recordCount: 1247, status: 'fresh', lagMinutes: 5 },
  { source: 'entra', lastUpdate: new Date(Date.now() - 2 * 60 * 1000), recordCount: 8934, status: 'fresh', lagMinutes: 2 },
  { source: 'intune', lastUpdate: new Date(Date.now() - 15 * 60 * 1000), recordCount: 156, status: 'stale', lagMinutes: 15 },
  { source: 'exchange', lastUpdate: new Date(Date.now() - 8 * 60 * 1000), recordCount: 2341, status: 'fresh', lagMinutes: 8 },
];

export const getSeverityColor = (severity: Severity): string => {
  const colors: Record<Severity, string> = {
    critical: 'critical',
    high: 'high',
    medium: 'medium',
    low: 'low',
    info: 'info',
  };
  return colors[severity];
};

export const getStatusLabel = (status: string): string => {
  const labels: Record<string, string> = {
    new: 'Nouveau',
    inProgress: 'En cours',
    pending: 'En attente',
    resolved: 'Résolu',
    closed: 'Fermé',
    falsePositive: 'Faux positif',
  };
  return labels[status] || status;
};

export const getSourceLabel = (source: string): string => {
  const labels: Record<string, string> = {
    defender: 'Defender XDR',
    entra: 'Entra ID',
    intune: 'Intune',
    exchange: 'Exchange Online',
  };
  return labels[source] || source;
};

export const getAnomalyTypeLabel = (type: string): string => {
  const labels: Record<string, string> = {
    bruteforce: 'Brute-force',
    impossibleTravel: 'Voyage impossible',
    rareCountry: 'Pays rare',
    newDevice: 'Nouvel appareil',
    legacyAuth: 'Auth legacy',
    mfaFailed: 'Échec MFA',
  };
  return labels[type] || type;
};

export const getRoleLabel = (role: string): string => {
  const labels: Record<string, string> = {
    admin: 'SOC Admin',
    analyst: 'Analyst',
    readonly: 'Lecture seule',
    helpdesk: 'IT Helpdesk',
  };
  return labels[role] || role;
};